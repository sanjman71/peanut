- title('Edit User')
- stylesheet('users', 'notes')
- javascript('users', 'notes')

- form_for(@user, :url => url_for(:controller => 'users', :action => 'update', :role => @role, :subdomain => current_subdomain), :method => :post) do |f|
  
  .span-23.prepend-1.last.mat.padding-bottom-20
    %h3.padding-top-10{:style => 'font-size: 2.0em;'}== Edit Profile

  %hr.space

  -# show any user errors
  - unless @user.errors.blank?
    .span-16.notice
      = error_messages_for('user', :header_message => nil)
  
  -# name
  .span-20.last
    .span-4.text-align-right
      %h3{:style => 'font-size: 1.8em; padding-top: 15px;'}= label_tag "user_name", "Name:"
    .span-16.last
      = f.text_field :name, :class => 'text title', :style => "width: 300px;"
  
  -# email, nested model
  - f.fields_for :email_addresses do |email_form|
    .span-20.last
      .span-4.text-align-right
        %h3{:style => 'font-size: 1.8em; padding-top: 15px;'}= label_tag "user_email", "Email:"
      .span-16.last
        -# not allowed to edit rpx user emails
        = email_form.text_field :address, :class => 'text title', :style => "width: 300px;", :id => 'user_email', :disabled => @user.rpx?
        - if email_form.object.verified?
          %span{:style => 'padding-left: 7px; font-weight: bold;'}== Verified
          
  -# phone, nested model
  - f.fields_for :phone_numbers do |phone_form|
    .span-20.last
      .span-4.text-align-right
        %h3{:style => 'font-size: 1.8em; margin-top: 15px;'}= label_tag "phone_address", "Phone:"
      .span-16.last
        = phone_form.text_field :address, :class => 'text title', :style => "width: 300px;", :id => 'phone_address'
        - if phone_form.object.verified?
          %span{:style => 'padding-left: 7px; font-weight: bold;'}== Verified
    .span-20.last
      .span-4.text-align-right
        %h3{:style => 'font-size: 1.8em; margin-top: 14px;'}= label_tag "phone_name", "Phone Name:"
      .span-16.last
        = phone_form.text_field :name, :class => 'text title', :style => "width: 300px;", :id => 'phone_name'
        %em{:style => 'padding-left: 5px; font-size: 1.1em;'}== e.g. Mobile, Work, Other

  - unless @user.rpx == 1
    -# password
    .span-20.last
      .span-4.text-align-right
        %h3{:style => 'font-size: 1.8em; padding-top: 15px;'}= label_tag "user_password", "Password:"
      .span-16.last
        = f.password_field :password, :class => 'text title', :style => "width: 300px;"

    -# password confirmation
    .span-20.last
      .span-4.text-align-right
        %h3{:style => 'font-size: 1.3em; padding-top: 20px;'}= label_tag "user_password", "Password Again:"
      .span-16.last
        = f.password_field :password_confirmation, :class => 'text title', :style => "width: 300px;"

  %hr.space

  .span-20.prepend-1.last.submit
    = submit_tag "Save Changes", :id => 'user_update_submit'
    == or
    = link_to "Cancel", @index_path, :class => 'admin'

%hr.space
  
.span-15.prepend-1
  -# notes flash message
  #note_flash

  -# add new note
  .new_note#new_note_container
    %p
      %h4.bottom== Add a note:
      = render(:partial => 'notes/add_note.html.haml', :locals => {:note => @note || Note.new, :subject => @user})
  %hr.space
  -# customer notes
  #notes_collection
    = render(:partial => 'notes/notes.html.haml', :locals => {:notes => @notes})


