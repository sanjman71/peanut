- title("Events")
- stylesheet('calendar')
/ - javascript('events')

.span-24
  .span-23.prepend-1.last.mat.shaded.padding-top-10.padding-bottom-10
    .span-15
      %h2== Events
      - if (@seen == true)
        %h3== #{link_to "Unseen", url_for(:subdomain => current_subdomain, :state => nil)} | Seen
      - else
        %h3== Unseen | #{link_to "Seen", url_for(:subdomain => current_subdomain, :state => 'seen')}
      
%hr.space

- if has_privilege?('create events', current_company)
  .span-23.prepend-1.mat.padding-top-10.padding-bottom-10
    %h3==Add an Event
    - form_for(Event.new, :url => events_url(:subdomain => current_subdomain), :method => :post) do |f|
      = hidden_field_tag :event_company_id, current_company.id
      = hidden_field_tag :event_user_id, current_user.id
      = f.select :etype, [["Urgent", 1], ["Approval", 2], ["Informational", 3]], {:selected => nil}
      == &nbsp;
      = f.label :message, "Message: "
      = f.text_field :message
      = f.submit

  %hr.space

#events
  - unless @urgent.empty?
    .urgent.last
      %h3.prepend-1
        %span{:style => 'background-color: #FFCC00;'}==Urgent
      - @urgent_by_day.each do |date, events|
        .prepend-1
          -# show event day of week and month day 
          .span-2= render(:partial => 'shared/calendar_cube', :locals => {:date => date})
          .span-2.last= render(:partial => 'shared/days_ago', :locals => {:date => date})
        - reset_cycle
        = render(:partial => 'events', :object => events)
        %hr.space
      
  - unless @approval.empty?
    .approval.last
      %h3.prepend-1
        %span{:style => 'background-color: #FFCC00;'}==Approval
      - reset_cycle
      = render(:partial => 'events', :object => @approval)
      %hr.space
      
  - unless @informational.empty?
    .informational.last
      %h3.prepend-1
        %span{:style => 'background-color: #FFCC00;'}==Informational
      - @informational_by_day.each do |date, events|
        .prepend-1
          -# show event day of week and month day 
          .span-2= render(:partial => 'shared/calendar_cube', :locals => {:date => date})
          .span-2.last= render(:partial => 'shared/days_ago', :locals => {:date => date})
        - reset_cycle
        = render(:partial => 'events', :object => events)
        %hr.space
